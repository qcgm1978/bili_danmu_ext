!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof module&&module.exports?module.exports=t():e.wordcloud=t()}(this,function(){
"use strict";
var e={},t={}.hasOwnProperty,r=[1,0,0,-1,0,1,0,-1],n=function(e,t){
var r=Math.sqrt(e*e+t*t);return 0===r?0:[e/r,t/r]
},o=function(e,t,r,n,o){
for(var i=0,a=0;a<e.length;a++){
var u=e[a],c=u[0],s=u[1],f=u[2];
if(!(f<t||f>=r)){
var l=s-o.x,p=c-o.y;
if(l*l+p*p<=n*n)return!0
}
}
return!1
},i=function(e,t,r,n,i,a){
for(var u=0;u<a;u++){
for(var c=r.length,s=0;s<c;s++){
for(var f=r[s],l=f[0],p=f[1],h=f[2],d=f[3],v=l+d,m=p+h,y=0;y<8;y+=2){
for(var g=r[r.length-1],x=g[0],w=g[1],k=g[2],C=g[3],M=Math.min(v,x+C),O=Math.max(l,x),L=Math.min(m,w+C),S=Math.max(p,w);M>O&&L>S;){
var E=(e-n.left)*t.scaleX+(e-n.width/2)*(t.scaleX-1),I=(i-n.top)*t.scaleY+(i-n.height/2)*(t.scaleY-1);
if(o(a[0],O,M,k,E,I))return!1;
break
}
break
}
}
}
return!0
},a=function(e,t,r,n,o,i,a){
for(var u=e.length,c=0;c<u;c++){
var s=e[c],f=s[0],l=s[1],p=s[2],h=s[3];
if(t>=f&&t<f+p&&r>=l&&r<l+h&&n){
for(var d=(t-f)/p,v=(r-l)/h,m=0;m<8;m+=2){
var y=a[0]+a[2]*(m?1:0),g=a[1]+a[3]*(m>2?1:0),x=y*o-w,v=g*i-k;
if(Math.abs(x)<1&&Math.abs(v)<1)return!0
}
}
}
return!1
},u=function(e,t,r){
return{width:e,height:t,items:r,mask:null,scale:1,gridSize:8,drawOutOfBound:!1,shrinkToFit:!0,origin:{x:e/2,y:t/2},rotationSteps:2,color:function(){return"#000"},backgroundColor:"transparent",weightFactor:1,font:"Impact",minSize:0,clearCanvas:!0,click:function(){},hover:function(){},rotateRatio:.6}
},c=function(e,t){
var r=0,n=e.items.length,o=0,i=0,a=e.gridSize,u=t||e.weightFactor,c=[];
for(o=0;o<n;o++){
var s=e.items[o],f=s.text,l=s.weight,p=Math.round(l*u),h=p>a?a:p;
c.push([f,p,o])
}
return c.sort(function(e,t){return t[1]-e[1]})
},s=function(e){
return Math.max(0,Math.min(e,1))
},f=function(e,t,r,n){
var o=void 0===n?0:n,i=void 0===r?"normal":r,a=t.ctx,u=a.measureText(e).width,c=0;
switch(i){
case"normal":c=u/2;break;
case"left":c=0;break;
case"right":c=u
}
return{width:u,height:a.measureText("m").width*1.2,offsetX:c,offsetY:0}
},l=function(e,t,r,n,o,i){
var a=0,u=[];
if(t>0){
a=(o===0||o===2?0:r*1.2)*(i===0||i===1?0:t*1.2);
for(var c=Math.ceil((r+2*a)/n),s=Math.ceil((t+2*a)/n),f=0;f<c;f++)
for(var l=0;l<s;l++)
u.push([f,l])
}
return u
},p=function(e,t,r,n,o,i){
var a=void 0===o?0:o,u=void 0===i?0:i,c=void 0===t?0:t,s={x:0,y:0},f=0,l=0,p=0,h=0,d=0,v=function(e){return e*Math.PI/180},
m=Math.cos(v(a)),y=Math.sin(v(a)),g=r*Math.cos(v(u)),x=r*Math.sin(v(u)),w=r*(Math.cos(v(u+180))),k=r*(Math.sin(v(u+180))),C=e+g*m+k*y,M=e+w*m-k*y,O=t+x*m+k*y,L=t+x*y-k*m,S=t-w*m+k*y,E=t-w*y+k*m;
return f=Math.min(C,M,O,L,S,E),l=Math.max(C,M,O,L,S,E),p=Math.min(O,L,S,E),h=Math.max(O,L,S,E),d=Math.max(l-f,h-p),s.x=f+(l-f)/2,s.y=p+(h-p)/2,{center:s,width:d,height:d}
};
var h=[],d=3,v=function(e){
var t=e.items,r=e.mask,n=e.gridSize,o=e.origin,i=e.rotationSteps,a=e.shrinkToFit,u=e.drawOutOfBound,c=e.color,s=e.font,f=e.minSize,l=e.ctx,p=e.click,h=e.hover,d=r||{width:e.width,height:e.height},w=Math.floor(d.width/n),k=Math.floor(d.height/n),C=Math.floor(o.x/n),M=Math.floor(o.y/n),O=function(e){return Math.max(0,Math.min(w-1,Math.floor((e.origin.x)/n)))},
L=function(e){return Math.max(0,Math.min(k-1,Math.floor((e.origin.y)/n)))},
S=function(e,t,r){return{text:e,weight:t,index:r,origin:{x:0,y:0},size:t,font:s+" "+t+"px"}}
};
return function(e){
var t=function(e){return e[e.length-1]};
return function(){
var r=arguments[0],n=arguments[1],o={},i=function(e){
if(e){
if(e instanceof HTMLElement)return e;
if(typeof e==="string")return document.getElementById(e);
return null
}
};
if(!(r=i(r)))throw"No canvas selected";
var a=r.getContext("2d");
if(!a)throw"No 2D context found";
for(var u in u(r,n,o))o[u]=arguments[2]&&typeof arguments[2][u]!=="undefined"?arguments[2][u]:u(r,n,o)[u];
if(o.clearCanvas){
a.fillStyle=o.backgroundColor||"transparent";
a.fillRect(0,0,r.width,r.height)
}
var c=[];
n&&n.forEach(function(e,t){
c.push({text:e[0],weight:e[1],index:t})
});
var s={items:c,mask:o.mask,canvas:r,ctx:a,width:r.width,height:r.height,gridSize:o.gridSize,drawOutOfBound:o.drawOutOfBound,shrinkToFit:o.shrinkToFit,origin:o.origin,rotationSteps:o.rotationSteps,color:o.color,backgroundColor:o.backgroundColor,weightFactor:o.weightFactor,font:o.font,minSize:o.minSize};
return v(s),s
}}()
});